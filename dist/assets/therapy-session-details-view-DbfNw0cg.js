import{au as N,u as w,b as I,r as i,C as o,a0 as l,p as u,j as s,g as j,T as a,z as t,h,d as p,K as b,ak as P,bi as A,N as E,F as C}from"./index-CynfWJw_.js";import{b as B}from"./format-number-mJfZlBY4.js";import{C as O}from"./confirm-dialog-CIzJmROj.js";import{C as $}from"./custom-breadcrumbs-D1SIBx8r.js";import{C as F}from"./Card-CrNj0u9u.js";import{G as y}from"./Grid-DBuOJ6h1.js";import"./DialogTitle-DxWrXely.js";import"./DialogContent-C7q4RNtx.js";function W(){const{id:r}=N(),c=w(),m=I(),[e,S]=i.useState(null),[f,g]=i.useState(!0),d=i.useCallback(async()=>{try{const n=await fetch(`${o.psikoHekimBaseUrl}${o.therapySession.details}/${r}`);if(!n.ok)throw new Error("Failed to fetch session details");const x=await n.json();S(x)}catch(n){console.error("Error fetching session details:",n),l("Seans detayları yüklenirken bir hata oluştu",{variant:"error"})}finally{g(!1)}},[r]);i.useEffect(()=>{d()},[d]);const k=i.useCallback(()=>{c.push(u.dashboard.therapySession.edit(r))},[c,r]),D=i.useCallback(async()=>{try{if(!(await fetch(`${o.psikoHekimBaseUrl}${o.therapySession.complete}/${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionNotes:"",therapistNotes:""})})).ok)throw new Error("Failed to complete session");l("Seans başarıyla tamamlandı",{variant:"success"}),d()}catch(n){console.error("Error completing session:",n),l("Seans tamamlanırken bir hata oluştu",{variant:"error"})}},[r,d]),v=i.useCallback(async()=>{try{const n=sessionStorage.getItem("jwt_access_token");if(!(await fetch(`${o.psikoHekimBaseUrl}${o.therapySession.cancel}/${r}`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({reason:"İptal edildi",cancelledBy:"THERAPIST"})})).ok)throw new Error("Failed to cancel session");l("Seans başarıyla iptal edildi",{variant:"success"}),d()}catch(n){console.error("Error cancelling session:",n),l("Seans iptal edilirken bir hata oluştu",{variant:"error"})}},[r,d]),L=i.useCallback(()=>{c.push(u.dashboard.therapySession.reschedule(r))},[c,r]),T=i.useCallback(async()=>{try{const n=sessionStorage.getItem("jwt_access_token");if(!(await fetch(`${o.psikoHekimBaseUrl}${o.therapySession.delete}/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to delete session");l("Seans başarıyla silindi",{variant:"success"}),c.push(u.dashboard.therapySession.list)}catch(n){console.error("Error deleting session:",n),l("Seans silinirken bir hata oluştu",{variant:"error"})}},[r,c]);return f?s.jsx(j,{maxWidth:"xl",children:s.jsx(a,{children:"Yükleniyor..."})}):e?s.jsxs(j,{maxWidth:"xl",children:[s.jsx($,{heading:"Seans Detayları",links:[{name:"Dashboard",href:u.dashboard.root},{name:"Terapi Seansları",href:u.dashboard.therapySession.root},{name:"Detaylar"}],action:s.jsxs(t,{direction:"row",spacing:1,children:[s.jsx(h,{variant:"outlined",color:"inherit",onClick:k,disabled:e.status==="COMPLETED"||e.status==="CANCELLED",startIcon:s.jsx(p,{icon:"solar:pen-bold"}),children:"Düzenle"}),s.jsx(h,{variant:"outlined",color:"success",onClick:D,disabled:e.status==="COMPLETED"||e.status==="CANCELLED",startIcon:s.jsx(p,{icon:"solar:check-circle-bold"}),children:"Tamamla"}),s.jsx(h,{variant:"outlined",color:"warning",onClick:L,disabled:e.status==="COMPLETED"||e.status==="CANCELLED",startIcon:s.jsx(p,{icon:"solar:calendar-mark-bold"}),children:"Yeniden Planla"}),s.jsx(h,{variant:"outlined",color:"error",onClick:v,disabled:e.status==="COMPLETED"||e.status==="CANCELLED",startIcon:s.jsx(p,{icon:"solar:close-circle-bold"}),children:"İptal Et"}),s.jsx(h,{variant:"outlined",color:"error",onClick:m.onTrue,startIcon:s.jsx(p,{icon:"solar:trash-bin-trash-bold"}),children:"Sil"})]}),sx:{mb:{xs:3,md:5}}}),s.jsx(F,{children:s.jsxs(t,{spacing:3,sx:{p:3},children:[s.jsxs(y,{container:!0,spacing:3,children:[s.jsx(y,{item:!0,xs:12,md:6,children:s.jsxs(t,{spacing:3,children:[s.jsxs(t,{direction:"row",alignItems:"center",spacing:2,children:[s.jsx(b,{alt:e.patient.name,src:e.patient.avatarUrl,sx:{width:64,height:64}}),s.jsxs(t,{children:[s.jsx(a,{variant:"h6",children:e.patient.name}),s.jsx(a,{variant:"body2",color:"text.secondary",children:e.patient.email})]})]}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"Seans Tarihi"}),s.jsxs(a,{variant:"body2",children:[P(e.scheduledDate)," ",A(e.scheduledDate)]})]}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"Seans Türü"}),s.jsx(a,{variant:"body2",children:e.sessionType==="INDIVIDUAL"?"Bireysel":"Çift"})]}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"Seans Formatı"}),s.jsx(a,{variant:"body2",children:e.sessionFormat==="IN_PERSON"?"Yüz Yüze":"Online"})]})]})}),s.jsx(y,{item:!0,xs:12,md:6,children:s.jsxs(t,{spacing:3,children:[s.jsxs(t,{direction:"row",alignItems:"center",spacing:2,children:[s.jsx(b,{alt:e.therapist.name,src:e.therapist.avatarUrl,sx:{width:64,height:64}}),s.jsxs(t,{children:[s.jsx(a,{variant:"h6",children:e.therapist.name}),s.jsx(a,{variant:"body2",color:"text.secondary",children:e.therapist.email})]})]}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"Durum"}),s.jsxs(E,{variant:"soft",color:e.status==="SCHEDULED"&&"info"||e.status==="COMPLETED"&&"success"||e.status==="CANCELLED"&&"error"||"default",children:[e.status==="SCHEDULED"&&"Planlandı",e.status==="COMPLETED"&&"Tamamlandı",e.status==="CANCELLED"&&"İptal Edildi"]})]}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"Ödeme Durumu"}),s.jsxs(E,{variant:"soft",color:e.paymentStatus==="PAID"&&"success"||e.paymentStatus==="PENDING"&&"warning"||e.paymentStatus==="NOT_APPLICABLE"&&"default"||"default",children:[e.paymentStatus==="PAID"&&"Ödendi",e.paymentStatus==="PENDING"&&"Bekliyor",e.paymentStatus==="NOT_APPLICABLE"&&"Uygulanamaz"]})]}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"Seans Ücreti"}),s.jsx(a,{variant:"body2",children:B(e.sessionFee)})]})]})})]}),e.sessionNotes&&s.jsxs(s.Fragment,{children:[s.jsx(C,{}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"Seans Notları"}),s.jsx(a,{variant:"body2",children:e.sessionNotes})]})]}),e.cancellationReason&&s.jsxs(s.Fragment,{children:[s.jsx(C,{}),s.jsxs(t,{spacing:1,children:[s.jsx(a,{variant:"subtitle2",children:"İptal Nedeni"}),s.jsx(a,{variant:"body2",children:e.cancellationReason})]})]})]})}),s.jsx(O,{open:m.value,onClose:m.onFalse,title:"Seansı Sil",content:"Bu seansı silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.",action:s.jsx(h,{variant:"contained",color:"error",onClick:()=>{T(),m.onFalse()},children:"Sil"})})]}):s.jsx(j,{maxWidth:"xl",children:s.jsx(a,{children:"Seans bulunamadı"})})}export{W as TherapySessionDetailsView};
